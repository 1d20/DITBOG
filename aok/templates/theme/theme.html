{% extends "base.html" %}

{% block title %}{{ title }}{% endblock %}

{% block head_ex %}
    <style>
        ul {list-style: none;}
        li {list-style: none;
            position:relative;
            max-width: 120px;}
        .delete-image{
            position:absolute;
            width:20px;
            height: 20px;
            top:0;
            right:0;
            background:red;
            color:white;
            display: none;
        }
        img { width: 120px;}
    </style>
{% endblock %}

{% block content  %}

{% include "theme/elements/left_menu.html" %}
<div class="table-responsive col-lg-10">
    <p name="theme_id" style="display:none">{{ theme.id }}</p>
    <h1 style="color:WHITE">{{ theme.title }}</h1>
    <h4><b>Version:</b> {{ theme.version }}</h4>
    <h4><b>Package name:</b> {{ theme.package_name }}</h4>
    <h4><b>Advertisemnt:</b></h4>

    <table style="color:WHITE" class="table table-striped table-hover">
        <thead>
            <tr> <th> Ad name </th> <th> Value </th> </tr>
        </thead>
        <tbody>
        {% for theme_ad in theme.themead_theme.all %}
            <tr>
                <td>{{ theme_ad.ad.title }}</td>
                <td>{{ theme_ad.value }}</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>

    <h4><b>APK:</b>
        {% if theme.path_to_apk %}<a href="{{ theme.path_to_apk.url }}">download</a>{% endif %}</h4>
    <div class="panel panel-warning">
        <div class="panel-heading"> <h4>Resources:</h4> </div>
        <div class="panel-body"> {% if theme.path_res_folder %}
        <form id="uploadForm" action="/theme/zip/type/" method="post" enctype="multipart/form-data">
            {% csrf_token %}
            <input  style="color:WHITE" id="fileInput" class="input-file" name="upload" type="file">
            <span class="upload-message"></span>
            <input type="submit" value="Upload" />
            <h5>
                <input type="button" value="Resoures" data-result-id="1" data-source-url="{{ theme.path_res_folder.url }}">
            </h5>
        </form>
            {% endif %}</div>
    </div>
    <div class="panel panel-warning">
        <div class="panel-heading"> <h4>Assets:</h4> </div>
        <div class="panel-body"> {% if theme.path_asset_folder %}<h5>
            <input type="button" value="Assets" data-result-id="2" data-source-url="{{ theme.path_asset_folder.url }}">
        </h5>{% endif %} </div>
    </div>
    <div class="panel panel-warning">
        <div class="panel-heading">
            <h4>Description:</h4>
        </div>
        </br>
        {% for desc in theme.description_theme.all %}
        <div class="panel panel-warning">
            <div class="panel-heading">
            <h3 class="panel-title">{{ desc.language }}</h3>
            </div>
            <div class="panel-body">
                <form id="descForm" action="/theme/edit_description/{{ desc.pk }}/" method="post">
                    {% csrf_token %}
                    <p><b>Title:</b>
                        <textarea rows="10" cols="45" name="text">{{ desc.title }}</textarea></p>
                    <p><b>Keywords:</b><textarea rows="10" cols="45" name="text"> {{ desc.keywords }}</textarea></p>
                    <p><b>Short description:</b><textarea rows="10" cols="45" name="text"> {{ desc.view_full_description }}</textarea></p>
                    <p><b>Full description:</b><textarea rows="10" cols="45" name="text"> {{ desc.view_short_description }}</textarea></p>
                    <p><b>Feathures:</b><textarea rows="10" cols="45" name="text"> {{ desc.feathures }}</textarea></p>
                    <p><b>Icon:</b></br><img src="{% if desc.path_app_icon %}{{ desc.path_app_icon.url }}{% endif %}"></p>
                    <p><b>Large promo:</b></br><img src="{% if desc.path_large_promo %}{{ desc.path_large_promo.url }}{% endif %}"></p>
                    <p><b>Screens:</b></br>{% if theme.path_full_description %}{{ desc.path_screens_folder.url }}{% endif %}</p>
                    <p><input type="submit" value="Send"></p>
                </form>
            </div>
        </div>
        {% endfor %}
    </div>
</div>

<script>
	$.each($('[data-result-id]'), function(){
		$(this).on('click', function(){
			var id = $(this).data('result-id');
			$(this).after($('<div id="result'+id+'">'));
			main(id);
			// console.log(id);
		});
	});
    var descForm = $("#descForm");
    //console.log(descForm.serialize());
    descForm.submit(function(e)
    {
        var postData = $(this).serializeArray();
        var formURL = $(this).attr("action");
        $.ajax(
        {
            url : formURL,
            type: "POST",
            data : postData,
            success:function(data, textStatus, jqXHR) 
            {
                console.log(data);
            },
            error: function(jqXHR, textStatus, errorThrown) 
            {
                console.log('submit fails');   
            }
        });
        e.preventDefault(); //STOP default action
        //e.unbind(); //unbind. to stop multiple form submit.
    });
     
    //descForm.submit(); //Submit  the FORM
</script>
{% endblock %}
